<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>B-OXY • Extrusão SVG (embutido, sem CORS)</title>
  <style>
    html, body { height: 100%; margin: 0; background: #111; }
    #app { position: fixed; inset: 0; }
    .hud {
      position: fixed; left: 12px; bottom: 12px; color: #ccc;
      font: 12px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: rgba(0,0,0,.35); padding: 10px 12px; border-radius: 10px; backdrop-filter: blur(4px);
    }
    .hud code { color: #fff; }
    .btn {
      display:inline-block; margin:8px 8px 0 0; padding:6px 10px; border-radius:8px; border:1px solid #444; color:#ddd;
      text-decoration:none; background:#1b1b1b; cursor:pointer;
    }
  </style>
</head>
<body>
  <div id="app"></div>
  <div class="hud">
    <div>SVG do B‑OXY <strong>embutido</strong> neste arquivo (sem CORS).</div>
    <div>Arraste com o mouse para orbitar, roda para zoom. Tecla <code>R</code> liga/desliga rotação. Use os botões abaixo.</div>
    <div style="margin-top:6px">
      <a class="btn" href="#" id="toggleEnv">Ambiente</a>
      <a class="btn" href="#" id="toggleBars">Clones</a>
      <a class="btn" href="#" id="rotate">Auto-rotar (R)</a>
    </div>
  </div>

  <script type="module">
    import * as THREE from 'https://unpkg.com/three@0.161.0/build/three.module.js';
    import { OrbitControls } from 'https://unpkg.com/three@0.161.0/examples/jsm/controls/OrbitControls.js';
    import { SVGLoader } from 'https://unpkg.com/three@0.161.0/examples/jsm/loaders/SVGLoader.js';
    import { RoomEnvironment } from 'https://unpkg.com/three@0.161.0/examples/jsm/environments/RoomEnvironment.js';

    // SVG embutido
    const EMBEDDED_SVG = `<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 29.6.1, SVG Export Plug-In . SVG Version: 9.03 Build 0)  -->
<svg version="1.0" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 704.06 216.17" enable-background="new 0 0 704.06 216.17" xml:space="preserve">
<g>
	<g>
		<g>
			<path fill="#FFFFFF" d="M234.56,172.17v20.75c0,0.91,0.73,1.66,1.62,1.66h18.76v3.82h-19.46c-2.58,0-4.67-2.13-4.67-4.76v-21.47
				H234.56z"/>
			<path fill="#FFFFFF" d="M268.94,172.17h9.82c5.22,0,9.49,4.35,9.49,9.67v6.9c0,5.31-4.27,9.67-9.49,9.67h-9.82
				c-5.22,0-9.49-4.35-9.49-9.67v-6.9C259.44,176.52,263.72,172.17,268.94,172.17z M278.76,175.99h-9.82
				c-3.16,0-5.74,2.63-5.74,5.84v6.9c0,3.22,2.58,5.84,5.74,5.84h9.82c3.16,0,5.74-2.63,5.74-5.84v-6.9
				C284.5,178.62,281.92,175.99,278.76,175.99z"/>
			<path fill="#FFFFFF" d="M319.07,193.64c0,2.63-2.09,4.76-4.67,4.76h-12.14c-5.22,0-9.49-4.35-9.49-9.67v-6.9
				c0-5.32,4.27-9.67,9.49-9.67h15.15v3.82h-15.15c-3.15,0-5.74,2.64-5.74,5.84v6.9c0,3.21,2.59,5.84,5.74,5.84h11.44
				c0.9,0,1.63-0.74,1.63-1.66v-4.52h-7.71v-3.82h11.47V193.64z"/>
			<path fill="#FFFFFF" d="M327.34,172.17v26.23h-3.75v-26.23H327.34z"/>
			<path fill="#FFFFFF" d="M336.01,184.58c-2.5-0.9-4.18-3.32-4.18-6.02c0-3.53,2.81-6.39,6.27-6.39h20.04v3.82H338.1
				c-1.39,0-2.52,1.15-2.52,2.56c0,1.08,0.66,2.04,1.65,2.41l0.05,0.02l18.17,4.96l0.17,0.06c2.5,0.9,4.18,3.32,4.18,6.02
				c0,3.53-2.81,6.38-6.27,6.38h-20.04v-3.82h20.04c1.39,0,2.52-1.15,2.52-2.56c0-1.08-0.66-2.04-1.65-2.41l-0.05-0.02l-18.17-4.96
				L336.01,184.58z"/>
			<path fill="#FFFFFF" d="M376.44,175.99h-12.11v-3.82h27.98v3.82H380.2v22.41h-3.75V175.99z"/>
			<path fill="#FFFFFF" d="M400.59,172.17v26.23h-3.75v-26.23H400.59z"/>
			<path fill="#FFFFFF" d="M414.57,198.4c-5.22,0-9.49-4.35-9.49-9.67v-6.9c0-5.32,4.27-9.67,9.49-9.67h16.82v3.82h-16.82
				c-3.16,0-5.74,2.63-5.74,5.84v6.9c0,3.22,2.58,5.84,5.74,5.84h16.82v3.82H414.57z"/>
			<path fill="#FFFFFF" d="M440.19,198.4h-4.29l13.13-24.25c0.68-1.25,1.88-1.98,3.29-1.98s2.61,0.72,3.29,1.98l13.13,24.25h-4.29
				l-3.03-5.6h-18.2L440.19,198.4z M445.29,188.98h14.06l-7.03-12.99L445.29,188.98z"/>
		</g>
		<g>
			<path fill="#FFFFFF" d="M165.54,44.93c0-5.88-2.02-10.94-6.05-15.17l-9.68-9.91c-4.14-4.13-9.08-6.2-14.83-6.2h-69.6
				c-5.75,0-10.66,2.09-14.75,6.27c-4.09,4.17-6.13,9.21-6.13,15.09v86.99h90.48c5.75,0,10.69-2.12,14.83-6.35l9.53-9.75
				c4.13-4.23,6.21-9.29,6.21-15.17V73.1l-8.93-5.27l8.93-5.27V44.92V44.93z M143.61,71.9v27.67H77.64l-11.2,13.31V36.1h65.81
				L143.6,22.8v49.1H143.61z"/>
			<linearGradient id="SVGID_1_" gradientUnits="userSpaceOnUse" x1="78.1308" y1="50.7968" x2="135.2145" y2="76.5247">
				<stop  offset="0.4094" style="stop-color:#202AA8"/>
				<stop  offset="0.7592" style="stop-color:#C9C9FF"/>
				<stop  offset="1" style="stop-color:#FFFFFF"/>
			</linearGradient>
			<polygon fill="url(#SVGID_1_)" points="113.58,74.57 143.61,98.96 143.61,61.65 97.87,61.78 			"/>
			
				<linearGradient id="SVGID_00000121237848343407776520000018135950028381190071_" gradientUnits="userSpaceOnUse" x1="130.339" y1="81.8211" x2="72.4512" y2="57.7012">
				<stop  offset="0.4094" style="stop-color:#202AA8"/>
				<stop  offset="0.7592" style="stop-color:#C9C9FF"/>
				<stop  offset="1" style="stop-color:#FFFFFF"/>
			</linearGradient>
			<polygon fill="url(#SVGID_00000121237848343407776520000018135950028381190071_)" points="113.58,74.36 97.87,61.58 66.44,36.04 
				66.44,74.36 			"/>
			<polygon fill="#FFFFFF" points="230.94,78.6 185.41,78.6 185.41,57.69 230.94,57.69 230.94,78.6 			"/>
			<path fill="#FFFFFF" d="M506.5,13.8h-19.37c-6.6,0-12.9,2.73-17.42,7.54L444.41,48.3L412,13.79h-29.7l47.25,50.31l-54.65,58.18
				h19.39c6.59,0,12.88-2.72,17.4-7.51l32.77-34.8l39.74,42.32h29.72l-44.51-47.44l-20.04-0.16L506.5,13.8L506.5,13.8z"/>
			<path fill="#FFFFFF" d="M659.56,13.8h-19.37c-6.6,0-12.9,2.73-17.42,7.54L597.47,48.3l-32.42-34.51h-29.7L582.6,64.1
				l-54.65,58.18h19.39c6.59,0,12.88-2.72,17.4-7.51l94.83-100.98L659.56,13.8z"/>
			<path fill="#FFFFFF" d="M310.71,122.3h-30.59c-5.28,0-9.94-1.76-14.01-5.27c-0.61-0.62-1.96-1.8-4.03-3.56
				c-2.08-1.76-3.45-2.97-4.11-3.64c-0.67-0.67-1.67-1.78-3.05-3.33c-1.37-1.55-2.31-2.9-2.82-4.03s-1.02-2.56-1.52-4.26
				c-0.51-1.7-0.76-3.54-0.76-5.51V43.41c0-1.96,0.25-3.8,0.76-5.51c0.5-1.7,1.02-3.12,1.52-4.26c0.5-1.14,1.44-2.48,2.82-4.03
				c1.37-1.55,2.41-2.66,3.12-3.33c0.71-0.67,2.08-1.88,4.11-3.64c2.03-1.76,3.34-2.95,3.96-3.56c3.96-3.51,8.62-5.27,14.01-5.27
				h61.34c5.28,0,9.9,1.76,13.85,5.27c0.71,0.72,1.88,1.76,3.5,3.1c1.62,1.34,2.79,2.35,3.5,3.03s1.67,1.63,2.9,2.86
				c1.21,1.25,2.13,2.33,2.74,3.26c0.61,0.93,1.25,2.04,1.9,3.33c0.66,1.29,1.11,2.67,1.37,4.11c0.25,1.45,0.38,2.99,0.38,4.65
				v49.29c0,1.97-0.23,3.8-0.69,5.51c-0.46,1.7-0.96,3.12-1.52,4.26c-0.56,1.14-1.52,2.48-2.9,4.03c-1.37,1.55-2.38,2.67-3.05,3.33
				c-0.67,0.68-2.03,1.89-4.11,3.64c-2.08,1.76-3.42,2.95-4.03,3.56c-3.96,3.52-8.58,5.27-13.85,5.27H310.7L310.71,122.3z
				 M310.71,36.28H271.9v76.88l11.42-13.33h66.21V22.95l-11.27,13.33H310.71L310.71,36.28z"/>
		</g>
	</g>
</g>
</svg>
`;

    // Config
    const DEPTH = 8, BEVEL=true, BEVEL_SIZE=0.9, BEVEL_THICKNESS=0.8, BEVEL_SEGMENTS=2;
    const METALNESS=0.9, ROUGHNESS=0.28, USE_ORTHO=true, BARS_COUNT=12;

    const app = document.getElementById('app');
    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setPixelRatio(Math.min(devicePixelRatio, 2));
    renderer.setSize(innerWidth, innerHeight);
    renderer.outputColorSpace = THREE.SRGBColorSpace;
    renderer.toneMapping = THREE.ACESFilmicToneMapping; renderer.toneMappingExposure = 1.1;
    app.appendChild(renderer.domElement);

    const scene = new THREE.Scene(); scene.background = null;

    let camera;
    if (USE_ORTHO) {
      const frustumSize = 1200, aspect = innerWidth/innerHeight;
      camera = new THREE.OrthographicCamera((-frustumSize*aspect)/2, (frustumSize*aspect)/2, frustumSize/2, -frustumSize/2, -5000, 5000);
      camera.position.set(0,0,1000);
    } else {
      camera = new THREE.PerspectiveCamera(45, innerWidth/innerHeight, 0.1, 5000);
      camera.position.set(0, 200, 800);
    }

    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;

    const pmrem = new THREE.PMREMGenerator(renderer);
    const envRT = pmrem.fromScene(new RoomEnvironment(), 0.1);
    scene.environment = envRT.texture;

    scene.add(new THREE.AmbientLight(0xffffff, .35));
    const key = new THREE.DirectionalLight(0xffffff, 1.2); key.position.set(300,350,500); scene.add(key);
    const rim = new THREE.DirectionalLight(0x99ccff, .6); rim.position.set(-400,-200,350); scene.add(rim);

    const baseMaterial = new THREE.MeshStandardMaterial({ color: 0xffffff, metalness: METALNESS, roughness: ROUGHNESS });

    const root = new THREE.Group(); scene.add(root);
    const barsGroup = new THREE.Group(); barsGroup.visible=false; scene.add(barsGroup);

    // carregar do string embedado
    loadFromString(EMBEDDED_SVG);

    function loadFromString(svgText){
      for (let i=root.children.length-1; i>=0; i--) root.remove(root.children[i]);
      const svgDoc = new DOMParser().parseFromString(svgText, 'image/svg+xml');
      const loader = new SVGLoader();
      const data = loader.parse(svgDoc.documentElement);
      const group = new THREE.Group();
      for (const path of data.paths) {
        const shapes = SVGLoader.createShapes(path);
        for (const shape of shapes) {
          const geo = new THREE.ExtrudeGeometry(shape, {
            depth: DEPTH, bevelEnabled: BEVEL, bevelSize: BEVEL_SIZE, bevelThickness: BEVEL_THICKNESS,
            bevelSegments: BEVEL_SEGMENTS, curveSegments: 16, steps: 1
          });
          const mat = baseMaterial.clone();
          const style = path.userData.style || {};
          if (style.fill && style.fill!=='none') mat.color = new THREE.Color(style.fill);
          const mesh = new THREE.Mesh(geo, mat);
          mesh.scale.y = -1;
          group.add(mesh);
        }
      }
      // centraliza e escala
      const box = new THREE.Box3().setFromObject(group);
      const size = new THREE.Vector3(); const center = new THREE.Vector3();
      box.getSize(size); box.getCenter(center);
      group.position.x = -center.x; group.position.y = -center.y;
      const targetW = 900; const s = targetW/size.x; group.scale.setScalar(s);
      root.add(group);
      if (camera.isOrthographicCamera) fitOrthoToObject(camera, group, controls);
      createBarsAround(group);
    }

    function fitOrthoToObject(orthoCam, object, controls) {
      const box = new THREE.Box3().setFromObject(object);
      const size = new THREE.Vector3(); box.getSize(size);
      const margin = 1.25; const maxDim = Math.max(size.x, size.y)*margin;
      const aspect = innerWidth/innerHeight;
      orthoCam.left=-maxDim*aspect/2; orthoCam.right=maxDim*aspect/2;
      orthoCam.top=maxDim/2; orthoCam.bottom=-maxDim/2;
      orthoCam.near=-5000; orthoCam.far=5000; orthoCam.updateProjectionMatrix();
      controls.target.set(0,0,0); controls.update();
    }

    function createBarsAround(target) {
      barsGroup.clear();
      const bb = new THREE.Box3().setFromObject(target);
      const size = new THREE.Vector3(); bb.getSize(size);
      const radius = Math.max(size.x,size.y)*0.85;
      for (let i=0;i<BARS_COUNT;i++){
        const len = radius*(1.2+Math.random()*0.8);
        const geo = new THREE.BoxGeometry(len,8,8);
        const hue = Math.random()*360;
        const col = new THREE.Color().setHSL(hue/360, .7, .5);
        const mat = new THREE.MeshStandardMaterial({ color: col, metalness:.2, roughness:.35, transparent:true, opacity:.75 });
        const bar = new THREE.Mesh(geo, mat);
        bar.position.set(0,0,-DEPTH*.6 - Math.random()*60);
        bar.rotation.z = (i/BARS_COUNT)*Math.PI*2 + Math.random()*0.2;
        bar.userData.spin = (Math.random()*0.6+0.2) * (Math.random()<0.5?-1:1);
        barsGroup.add(bar);
      }
    }

    let autoRotate=false;
    document.getElementById('rotate').addEventListener('click', e=>{ e.preventDefault(); autoRotate=!autoRotate; });
    document.getElementById('toggleEnv').addEventListener('click', e=>{ e.preventDefault(); scene.environment = scene.environment ? null : envRT.texture; renderer.toneMappingExposure = scene.environment ? 1.1 : 0.95; });
    document.getElementById('toggleBars').addEventListener('click', e=>{ e.preventDefault(); barsGroup.visible = !barsGroup.visible; });
    document.addEventListener('keydown', e=>{ if(e.key.toLowerCase()==='r') autoRotate=!autoRotate; });

    function animate(){
      requestAnimationFrame(animate);
      controls.update();
      if (autoRotate) root.rotation.z += 0.0025;
      for (const b of barsGroup.children) b.rotation.z += 0.0015*(b.userData.spin||1);
      renderer.render(scene, camera);
    }
    animate();

    addEventListener('resize', ()=>{
      renderer.setSize(innerWidth, innerHeight);
      if (camera.isOrthographicCamera) fitOrthoToObject(camera, root, controls);
      else { camera.aspect = innerWidth/innerHeight; camera.updateProjectionMatrix(); }
    });
  </script>
</body>
</html>
